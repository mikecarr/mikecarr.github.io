<!DOCTYPE html>
<html>
<head>
<title>OpenIPC Configuration</title>
<style>
/* Basic CSS Styling */
body {
  font-family: sans-serif;
  margin: 20px;
  background-color: #f4f4f4;
}

.container {
  width: 80%;
  margin: auto;
  background-color: #fff;
  padding: 20px;
  border-radius: 5px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

h1 {
  text-align: center;
  color: #333;
}

label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

input[type="text"],
input[type="password"],
select {
  width: 100%;
  padding: 8px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box; /* Important for width calculation */
}

button {
  background-color: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  float: right;
}

button:hover {
  background-color: #3e8e41;
}

.form-group {
  margin-bottom: 15px;
}

.error {
  color: red;
  font-size: 0.8em;
}

/* Clearfix to prevent floating issues */
.clearfix::after {
  content: "";
  clear: both;
  display: table;
}
</style>
</head>
<body>

<div class="container">
  <h1>OpenIPC Configuration</h1>

  <form id="openipc-form">

    <div class="form-group">
      <label for="camera-name">Camera Name:</label>
      <input type="text" id="camera-name" name="camera-name" placeholder="e.g., Living Room Camera" required>
      <span id="camera-name-error" class="error"></span>
    </div>

    <div class="form-group">
      <label for="network-mode">Network Mode:</label>
      <select id="network-mode" name="network-mode">
        <option value="dhcp" selected>DHCP</option>
        <option value="static">Static IP</option>
      </select>
    </div>

    <div id="static-ip-config" style="display: none;">
      <div class="form-group">
        <label for="static-ip">Static IP Address:</label>
        <input type="text" id="static-ip" name="static-ip" placeholder="192.168.1.100">
        <span id="static-ip-error" class="error"></span>
      </div>

      <div class="form-group">
        <label for="netmask">Netmask:</label>
        <input type="text" id="netmask" name="netmask" placeholder="255.255.255.0">
        <span id="netmask-error" class="error"></span>
      </div>

      <div class="form-group">
        <label for="gateway">Gateway:</label>
        <input type="text" id="gateway" name="gateway" placeholder="192.168.1.1">
        <span id="gateway-error" class="error"></span>
      </div>
    </div>

    <div class="form-group">
      <label for="admin-username">Admin Username:</label>
      <input type="text" id="admin-username" name="admin-username" value="admin" required>
      <span id="admin-username-error" class="error"></span>
    </div>

    <div class="form-group">
      <label for="admin-password">Admin Password:</label>
      <input type="password" id="admin-password" name="admin-password" required>
      <span id="admin-password-error" class="error"></span>
    </div>

    <div class="form-group">
      <label for="rtsp-port">RTSP Port:</label>
      <input type="text" id="rtsp-port" name="rtsp-port" value="8554">
      <span id="rtsp-port-error" class="error"></span>
    </div>

    <div class="clearfix">
      <button type="submit">Save Configuration</button>
    </div>

  </form>
</div>


<script>
// JavaScript for form handling and validation

const form = document.getElementById('openipc-form');
const networkModeSelect = document.getElementById('network-mode');
const staticIpConfigDiv = document.getElementById('static-ip-config');
const staticIpInput = document.getElementById('static-ip');
const netmaskInput = document.getElementById('netmask');
const gatewayInput = document.getElementById('gateway');
const cameraNameInput = document.getElementById('camera-name');

// Error message elements
const cameraNameError = document.getElementById('camera-name-error');
const staticIpError = document.getElementById('static-ip-error');
const netmaskError = document.getElementById('netmask-error');
const gatewayError = document.getElementById('gateway-error');
const rtspPortInput = document.getElementById('rtsp-port');
const rtspPortError = document.getElementById('rtsp-port-error');

// Function to validate IP address format
function isValidIPAddress(ip) {
  const ipRegex = /^(\d{1,3}\.){3}\d{1,3}$/;
  return ipRegex.test(ip) &&
         ip.split('.').every(octet => parseInt(octet) >= 0 && parseInt(octet) <= 255);
}

// Function to validate netmask format (simplified)
function isValidNetmask(netmask) {
    const netmaskRegex = /^(\d{1,3}\.){3}\d{1,3}$/;
    return netmaskRegex.test(netmask) &&
           netmask.split('.').every(octet => parseInt(octet) >= 0 && parseInt(octet) <= 255);
}

function isValidPort(port) {
    const portNumber = parseInt(port);
    return !isNaN(portNumber) && portNumber > 0 && portNumber <= 65535;
}


// Event listener for network mode change
networkModeSelect.addEventListener('change', function() {
  if (this.value === 'static') {
    staticIpConfigDiv.style.display = 'block';
  } else {
    staticIpConfigDiv.style.display = 'none';
  }
});


// Form submission handling
form.addEventListener('submit', function(event) {
  event.preventDefault(); // Prevent default form submission

  // Reset error messages
  cameraNameError.textContent = '';
  staticIpError.textContent = '';
  netmaskError.textContent = '';
  gatewayError.textContent = '';
  rtspPortError.textContent = '';


  let isValid = true;

  // Validate Camera Name (example: not empty)
  if (cameraNameInput.value.trim() === '') {
      cameraNameError.textContent = 'Camera name is required.';
      isValid = false;
  }


  // Validate Static IP fields if Static IP is selected
  if (networkModeSelect.value === 'static') {
    if (!isValidIPAddress(staticIpInput.value)) {
      staticIpError.textContent = 'Invalid IP address format.';
      isValid = false;
    }

    if (!isValidNetmask(netmaskInput.value)) {
      netmaskError.textContent = 'Invalid netmask format.';
      isValid = false;
    }

    if (!isValidIPAddress(gatewayInput.value)) {
      gatewayError.textContent = 'Invalid gateway format.';
      isValid = false;
    }
  }

   // Validate RTSP Port
   if (!isValidPort(rtspPortInput.value)) {
      rtspPortError.textContent = 'Invalid port number (1-65535).';
      isValid = false;
   }


  if (isValid) {
    // Gather form data
    const formData = new FormData(form);
    const data = {};
    for (const [key, value] of formData.entries()) {
      data[key] = value;
    }

    // Convert the data to JSON
    const jsonData = JSON.stringify(data);

    // You would typically send this data to a server-side script (e.g., PHP, Python) for processing
    // Here, we just display it in the console for demonstration purposes
    console.log('Form Data (JSON):', jsonData);

    // Simulate a successful submission
    alert('Configuration saved successfully! (Data logged to console)');

    // You can then redirect the user or perform other actions
  } else {
    alert('Please correct the errors in the form.');
  }
});

</script>

</body>
</html>